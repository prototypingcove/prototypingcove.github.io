<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .results { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .metric { display: flex; justify-content: space-between; margin: 10px 0; }
        .good { color: green; }
        .warning { color: orange; }
        .bad { color: red; }
    </style>
</head>
<body>
    <h1>Portfolio Performance Test</h1>
    <div id="results"></div>
    
    <script>
        function formatTime(ms) {
            return ms < 1000 ? `${Math.round(ms)}ms` : `${(ms/1000).toFixed(2)}s`;
        }
        
        function getColorClass(value, good, warning) {
            if (value <= good) return 'good';
            if (value <= warning) return 'warning';
            return 'bad';
        }
        
        function runPerformanceTest() {
            const perfData = performance.getEntriesByType('navigation')[0];
            const paintEntries = performance.getEntriesByType('paint');
            
            const metrics = {
                'DNS Lookup': perfData.domainLookupEnd - perfData.domainLookupStart,
                'Connection': perfData.connectEnd - perfData.connectStart,
                'Request/Response': perfData.responseEnd - perfData.requestStart,
                'DOM Loading': perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart,
                'Total Load Time': perfData.loadEventEnd - perfData.navigationStart,
                'DOM Ready': perfData.domContentLoadedEventEnd - perfData.navigationStart
            };
            
            // Add paint metrics
            paintEntries.forEach(entry => {
                if (entry.name === 'first-contentful-paint') {
                    metrics['First Contentful Paint'] = entry.startTime;
                }
                if (entry.name === 'first-paint') {
                    metrics['First Paint'] = entry.startTime;
                }
            });
            
            // Resource loading
            const resources = performance.getEntriesByType('resource');
            const images = resources.filter(r => r.name.match(/\.(jpg|jpeg|png|gif|webp|svg)$/i));
            const scripts = resources.filter(r => r.name.match(/\.js$/i));
            const styles = resources.filter(r => r.name.match(/\.css$/i));
            
            metrics['Total Resources'] = resources.length;
            metrics['Images Loaded'] = images.length;
            metrics['Scripts Loaded'] = scripts.length;
            metrics['Stylesheets Loaded'] = styles.length;
            
            // Calculate total transfer size
            const totalSize = resources.reduce((total, resource) => {
                return total + (resource.transferSize || 0);
            }, 0);
            
            metrics['Total Transfer Size'] = `${(totalSize / 1024).toFixed(1)} KB`;
            
            let html = '<div class="results">';
            html += '<h2>Performance Metrics</h2>';
            
            Object.entries(metrics).forEach(([metric, value]) => {
                let displayValue = typeof value === 'number' ? formatTime(value) : value;
                let colorClass = '';
                
                // Set thresholds for different metrics
                if (typeof value === 'number') {
                    switch(metric) {
                        case 'Total Load Time':
                            colorClass = getColorClass(value, 2000, 4000); // 2s good, 4s warning
                            break;
                        case 'First Contentful Paint':
                            colorClass = getColorClass(value, 1500, 2500);
                            break;
                        case 'DOM Ready':
                            colorClass = getColorClass(value, 1000, 2000);
                            break;
                        default:
                            colorClass = getColorClass(value, 500, 1000);
                    }
                }
                
                html += `<div class="metric">
                    <span>${metric}:</span>
                    <span class="${colorClass}">${displayValue}</span>
                </div>`;
            });
            
            html += '</div>';
            
            // Performance recommendations
            html += '<div class="results">';
            html += '<h2>Recommendations</h2>';
            
            const recommendations = [];
            
            if (metrics['Total Load Time'] > 2000) {
                recommendations.push('âš ï¸ Total load time exceeds 2 seconds target');
            }
            
            if (metrics['First Contentful Paint'] > 1500) {
                recommendations.push('âš ï¸ First Contentful Paint is slow - optimize critical CSS and fonts');
            }
            
            if (images.length > 10) {
                recommendations.push('ðŸ“¸ Consider reducing number of images or lazy loading');
            }
            
            if (scripts.length > 5) {
                recommendations.push('ðŸ“œ Consider bundling JavaScript files');
            }
            
            if (totalSize > 500 * 1024) { // 500KB
                recommendations.push('ðŸ’¾ Total transfer size is large - optimize images and enable compression');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('âœ… Performance looks good!');
            }
            
            recommendations.forEach(rec => {
                html += `<div>${rec}</div>`;
            });
            
            html += '</div>';
            
            document.getElementById('results').innerHTML = html;
        }
        
        // Run test when page loads
        window.addEventListener('load', () => {
            setTimeout(runPerformanceTest, 100);
        });
    </script>
</body>
</html>